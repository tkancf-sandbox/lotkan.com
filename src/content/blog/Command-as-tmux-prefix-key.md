---
title: "Commandキーをtmuxのプレフィックスキーとして使う方法 on Iterm2"
description: "tmuxのプレフィックスキーとして、MacのCommandキーを割り当てる方法を解説します。"
pubDate: "2023/04/18"
heroImage: "/placeholder-hero.webp"
---

tmux のプレフィックスキーに最適なキーを探して数年が経ちました。
Vim のキーマップやターミナルのショートカットを考慮するとプレフィックスキーとして使える組み合わせってほぼ残って無いです。
(デフォルトの Ctrl+b とか、shell でめっちゃ多用します)

なので色々な組み合わせを試してきたんですが、最近 Mac だったら Command キーをプレフィックスキーとして使えば良いのでは？
と考えて設定してみたら結構いい感じです。

「Command キー+何かのキー」をプレフィックスキーとして使うメリットとしては

- 押しやすい位置にある
- ターミナルで動くツール(vim, bash, 他 CLI ツール類)とショートカットでバッティングすることが無い(多分)

が挙がります。  
親指で押せる位置にあるというのは、ターミナルで生活する者としては結構重要です。小指とかで押す Ctrl 等をプレフィックスキーとして使用すると小指が死んでしまいます。
Command キー単押しでプレフィックスキーとして動作させることも可能ですし、 `Commandキー + '` を tmux の pane 分割キーとして設定すること等も可能です。

## 前提

- 下記環境で動作確認を行っています。
  - macOS Catalina バージョン 10.15.5
  - iTerm2 Build 3.3.11
  - tmux 3.0a

## 設定方法

Iterm2 にはキーボードショートカットを自分で登録する機能が最初からついてます。
ショートカットを入力した際に色々なアクション(スクロールとかコピー等)を実行できるのですが、そんなアクションの中に "Send Hex Code" というアクションがあります。
その名の通りショートカットを入力した際に ASCII コードを送信してくれる機能です。  
これを利用して、Command キーを入力した際に tmux のプレフィックスキーとして設定したキーの ASCII コードを送信してもらいます。

どのキーが ASCII コードの 16 進数で何に該当するのかは下記サイトをみると分かります。  
ＡＳＣＩＩコード表: https://ja.wikipedia.org/wiki/ASCII

### tmux 側の設定

tmux の prefix 設定が何でも良いわけじゃないです。
tmux 的には `Ctrl-<Space>` をプレフィックスキーとして使うことが出来るのですが、上記 "send Hex Code" の機能としては上記 ASCII コード表に載っているような文字もしくは制御文字しか対応していません。

なので普段使わなさそうな制御文字をプレフィックスキーとして利用します。
ASCII コードの制御文字とその説明は Wikipedia みると概要は分かるかと思います。  
Wikipedia 制御文字: https://ja.wikipedia.org/wiki/%E5%88%B6%E5%BE%A1%E6%96%87%E5%AD%97

私は `Ctrl + \` を tmux のプレフィックスキーとして設定しました。 (制御文字としては File Separator だそうです。)

`.tmux.conf` の設定として書くなら下記のようになります。(エスケープするためにバッククォートが 2 つついてます。)

```tmux
# prefix key
set -g prefix C-\\
```

### Iterm2 側の設定

次に Iterm2 側の設定です。 Iterm2 の Preferences から設定します。(Preferences の開き方は`Commandキー + ,`)  
Preferences > Keys > Key Bindings の左下の + ボタンからキーボードショートカットを新しく登録します。

私の設定を例にすると、

1. Preferences > Keys > Key Bindings の左下の + ボタンを押す
2. Command キーの単押しをプレフィックスキーとして使いたいので、 "Keyboard Shortcut" のところをクリックして Command キーを押す
3. Action で "Send Hex Code" を選択する
4. Action の下に入力欄が出るので、そこに先程プレフィックスキーとして設定した制御文字の ASCII コードを入力する
   - (私は File Separator をプレフィックスキーとして設定したので、その ASCII コードである 1c を入力します)

上記設定ができれば下記画像のようになるはずです。

![Commandキーをプレフィックスキーとして設定できたときの画像](/Command-as-tmux-prefix-key/iterm2-setting.webp)

ここまでで Command キーをプレフィックスキーとして利用できます。動作確認して終わりです。お疲れさまでした。

### おまけ

ここまでの設定の応用として、`Commandキー + '` をプレフィックスキーを押したあとで ' キーを押したと同様の動作(tmux のデフォルト設定だと pane の分割) をするようにしてみます。

1. Preferences > Keys > Key Bindings の左下の + ボタンを押す
2. `Commandキー + '`をプレフィックスキーとして使いたいので、 "Keyboard Shortcut" のところをクリックして Command キーを押す
3. Action で "Send Hex Code" を選択する
4. Action の下に入力欄が出るので、そこに先程プレフィックスキーとして設定した制御文字の ASCII コードを入力し、半角スペースを入れて ' キーの ASCII コード(22) を入力します。
   - (私は File Separator をプレフィックスキーとして設定したので、その ASCII コードである 1c を入力します)

これで `Commandキー + '` を pane 分割のショートカットとして登録できました。  
この調子でよく使う tmux の操作をショートカットとして登録すると便利です。私の設定は現在下記画像の様になっていました。

![上記設定が全て完了した時の画像](/Command-as-tmux-prefix-key/iterm2-settings.webp)

Command キーをプレフィックスキーとして利用すると小指に優しいのでおすすめです。  
良かったらぜひ試してみて下さいませ。
